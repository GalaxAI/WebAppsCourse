<div class="container">
  <h1 class="page-title">Notes</h1>
  
  <div class="card">
    <h2 class="card-header">Create New Note</h2>
    <form action="/p16/notes" method="POST" class="note-form" enctype="multipart/form-data">
      <div class="form-group">
        <label for="title" class="form-label">Title:</label>
        <input type="text" id="title" name="title" required class="form-control" placeholder="Enter note title">
      </div>
      
      <div class="form-group">
        <label for="content" class="form-label">Content:</label>
        <textarea id="content" name="content" required class="form-control" rows="4" placeholder="Write your note here..."></textarea>
      </div>
      
      <div class="form-group">
        <label for="attachment" class="form-label">Attachment (optional):</label>
        <input type="file" id="attachment" name="attachment" class="form-control">
      </div>
    
      
      <button type="submit" class="btn btn-primary">
        <i class="fas fa-plus-circle"></i> Create Note
      </button>
    </form>
  </div>

  <div class="card">
    <h2 class="card-header">Existing Notes</h2>
    <div class="notes-list">
      <% if (notes && notes.length > 0) { %>
        <% notes.forEach(note => { %>
          <div class="note-item">
            <div class="note-header">
              <h3 class="note-title"><%= note.title %></h3>
              <form action="/p16/notes/<%= note.id %>/delete" method="POST" class="note-actions">
                <button type="submit" class="btn btn-danger btn-sm">
                  <i class="fas fa-trash"></i>
                </button>
              </form>
            </div>
            <div class="note-content"><%= note.content %></div>
            <% if (note.filePath) { %>
              <div class="note-attachment">
                <i class="fas fa-paperclip"></i>
                <%
                  const fileName = note.filePath.split('/').pop();
                  const fileExt = fileName.split('.').pop().toLowerCase();
                  const isImage = ['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp'].includes(fileExt);
                  const isPdf = fileExt === 'pdf';
                  const isText = ['txt', 'md'].includes(fileExt);
                %>

                <% if (isImage) { %>
                  <div class="attachment-preview">
                    <img src="<%= note.filePath %>" alt="<%= fileName %>" class="attachment-image">
                  </div>
                <% } else if (isPdf) { %>
                  <div class="attachment-preview">
                    <embed src="<%= note.filePath %>" type="application/pdf" width="100%" height="200px" />
                  </div>
                <% } else if (isText) { %>
                  <a href="<%= note.filePath %>" target="_blank" class="attachment-link">
                    <i class="fas fa-file-alt"></i> <%= fileName %>
                  </a>
                <% } else { %>
                  <a href="<%= note.filePath %>" download class="attachment-link">
                    <i class="fas fa-download"></i> <%= fileName %>
                  </a>
                <% } %>
              </div>
            <% } %>
          </div>
        <% }); %>
      <% } else { %>
        <div class="empty-state">
          <i class="fas fa-sticky-note empty-icon"></i>
          <p>No notes yet. Create your first note!</p>
        </div>
      <% } %>
    </div>
  </div>
</div>
